<ion-header [translucent]="true" mode="ios">
  <ion-toolbar>
    <ion-title>Paisa Paisa</ion-title>
    <ion-title class="ion-text-right" style="padding-inline: 0">
      <ion-button
        (click)="setOpen(true)"
        shape="round"
        fill="false"
        color="dark"
        class="ion-no-padding"
      >
        <ion-icon size="large" name="add-outline"></ion-icon>
      </ion-button>
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-header collapse="condense" mode="ios">
    <ion-toolbar style="padding: 0 16px">
      <ion-buttons slot="start">
        <ion-button color="dark" size="large" strong="true"
          ><h1 class="ion-no-margin">Paisa Paisa</h1></ion-button
        >
      </ion-buttons>
      <ion-buttons slot="end">
        <ion-button id="open-action-sheet" shape="round" color="dark">
          <ion-icon size="large" name="refresh"></ion-icon>
        </ion-button>
        <ion-action-sheet
          trigger="open-action-sheet"
          header="Are you sure?"
          [buttons]="actionSheetButtons"
          (didDismiss)="reset($event)"
        ></ion-action-sheet>
        <ion-button (click)="setOpen(true)" shape="round" color="dark">
          <ion-icon size="large" name="add-outline"></ion-icon>
        </ion-button>
      </ion-buttons>
    </ion-toolbar>
  </ion-header>

  <div class="">
    <ion-grid class="ion-margin-vertical">
      <ion-row
        class="ion-text-center ion-margin-bottom border ion-padding-vertical ion-justify-content-around ion-align-items-center"
      >
        <ion-col size="3" class="ion-padding sm-card">
          <ion-text color="danger">
            Spent
            <br />
            <b> {{spent}} </b>
          </ion-text>
        </ion-col>
        <ion-col size="3" class="ion-padding sm-card">
          <ion-text color="primary">
            Current
            <br />
            <b> {{current}} </b>
          </ion-text>
        </ion-col>
        <ion-col size="3" class="ion-padding sm-card">
          <ion-text color="success">
            Savings
            <br />
            <b> {{savings}} </b>
          </ion-text>
        </ion-col>
      </ion-row>

      <!-- <ion-row>
        <ion-col  offset="9">
          <ion-text color="dark"><i>History</i></ion-text>
        </ion-col>
      </ion-row> -->

      <ion-row>
        <ion-col>
          <ion-list [inset]="true" style="margin-top: 0; border-radius: 16px">
            <ion-item *ngFor="let transactionLog of transactionlist">
              <ion-icon
                slot="start"
                size="large"
                [name]="transactionLog?.type==='income'?'add-circle':'remove-circle'"
                [color]="transactionLog?.type==='income'?'success':'danger'"
              ></ion-icon>
              <ion-label
                [color]="transactionLog?.type==='income'?'success':'danger'"
              >
                <h2>{{transactionLog?.amount}}</h2>
                <small>{{transactionLog?.date|date}}</small>
              </ion-label>

              <ion-label slot="end" style="display: contents">
                <ion-label
                  [id]="'hover-'+ dateToMillisec(transactionLog?.date)"
                  slot="start"
                  style="
                    overflow: hidden;
                    text-overflow: ellipsis !important;
                    white-space: nowrap;
                    max-width: 35%;
                    text-align: center;
                  "
                >
                  {{transactionLog?.des }}
                </ion-label>
                <ion-popover [trigger]="'hover-'+ dateToMillisec(transactionLog?.date)" triggerAction="hover">
                  <ng-template>
                    <ion-content class="ion-padding">{{transactionLog?.des }}</ion-content>
                  </ng-template>
                </ion-popover>

                <ion-label
                  style="max-width: 25%"
                  slot="end"
                  class="ion-text-right"
                  [color]="transactionLog?.type==='income'?'success':'danger'"
                >
                  {{transactionLog?.account}}
                </ion-label>
              </ion-label>
            </ion-item>
          </ion-list>
        </ion-col>
      </ion-row>
    </ion-grid>
  </div>

  <ion-modal [isOpen]="isModalOpen" mode="ios">
    <ng-template>
      <ion-header>
        <ion-toolbar>
          <ion-buttons slot="start">
            <ion-button (click)="setOpen(false)">Cancel</ion-button>
          </ion-buttons>
          <ion-title>Add Entry</ion-title>
          <ion-buttons slot="end">
            <ion-button (click)="set()" [strong]="true">Confirm</ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>
      <ion-content class="ion-padding">
        <ion-list [inset]="true" style="border-radius: 16px">
          <ion-item lines="none">
            <ion-input
              type="number"
              fill="solid"
              label="Amount"
              labelPlacement="floating"
              helperText="Enter the amount"
              errorText="Invalid amount"
              [(ngModel)]="trans.amount"
              number
            ></ion-input>
          </ion-item>
          <ion-item>
            <ion-select
              placeholder="Select entry type"
              [(ngModel)]="trans.type"
            >
              <div slot="label">
                Type<ion-text color="danger">(Required)</ion-text>
              </div>
              <ion-select-option value="expense">Expense</ion-select-option>
              <ion-select-option value="income">Income</ion-select-option>
            </ion-select>
          </ion-item>
          <ion-item>
            <ion-select
              placeholder="Select account"
              [(ngModel)]="trans.account"
            >
              <div slot="label">
                Account<ion-text color="danger">(Required)</ion-text>
              </div>
              <ion-select-option value="savings">Savings</ion-select-option>
              <ion-select-option value="current">Current</ion-select-option>
            </ion-select>
          </ion-item>
          <ion-item lines="none">
            <ion-textarea
              class="ion-margin-vertical"
              fill="solid"
              label="Descripation"
              [(ngModel)]="trans.des"
            ></ion-textarea>
          </ion-item>
        </ion-list>
      </ion-content>
    </ng-template>
  </ion-modal>
</ion-content>
